{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/getInitialProps","webpackCompilationHash":"9c2ff3817128b4b9b194","result":{"data":{"markdownRemark":{"id":"20b366af-1995-5204-8ce8-cf4f2d06042f","html":"<p>NextJs에서 SSR(서버 사이드 렌더링)을 가능하게 하는 것이 바로 getInitialProps에 있다.<br>\nNextJS에서 모든 스크립트 코드는 NodeJs(서버)와 브라우저(클라이언트) 양쪽 모두에서<br>\n수행되지만 getInitialProps 함수는 서버나 클라이언트 중 한군데서만 실행된다.</p>\n<p>getInitialProps의 SSR 절차</p>\n<ol>\n<li>getInitialProps의 호출<br>\nURL 주소를 이용해 직접 특정 페이지에 접근하면 NodeJs 환경에서 getInitialProps가 호출된다.<br>\n브라우저(클라이언트)에서 SPA로 페이지 이동하는 경우 브라우저 환경에서 getInitialProps가<br>\n호출된다.</li>\n<li>getInitialProps가 plain object를 리턴하면 해당 객체가 그대로 class의 constructor의 props로 전달되거나 함수형일 경우 매개변수로 을 수 있다.</li>\n<li>서버에서 렌더링 된 html이 그대로 브라우저로 내려온다.</li>\n<li>브라우저에서는 constructor에서 props를 통해 전달받은 데이터를 이용해 추가적인 서버<br>\n요청없이 화면을 똑같이 다시 한번 그린다.</li>\n</ol>\n<p>ex)class 경우</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import React from &#39;react&#39;\n\nexport default class extends React.Component {\n  static async getInitialProps({ req }) {\n    const userAgent = req ? req.headers[&#39;user-agent&#39;] : navigator.userAgent\n    return { userAgent }\n  }\n\n  render() {\n    return (\n      &lt;div&gt;\n        Hello World {this.props.userAgent}\n      &lt;/div&gt;\n    )\n  }\n}</code></pre></div>\n<p>ex)함수형 경우</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">const Page = ({ stars }) =&gt;\n  &lt;div&gt;\n    Next stars: {stars}\n  &lt;/div&gt;\n\nPage.getInitialProps = async ({ req }) =&gt; {\n  const res = await fetch(&#39;https://api.github.com/repos/zeit/next.js&#39;)\n  const json = await res.json()\n  return { stars: json.stargazers_count }\n}\n\nexport default Page</code></pre></div>\n<p>getInitialProps에서 사용할 수 있는 속성</p>\n<p>pathname: path section of URL<br>\nquery: query string section of URL parsed as an object<br>\nasPath: String of the actual path shows in the browser<br>\nreq: HTTP request object(server only)<br>\nres: HTTP response object(server only)<br>\njsonPageRes: Fetch Response object(client only)<br>\nerr: Error object if any error is encountered during the rendering</p>\n<p>주의사항<br>\ngetInitialProps는 pages 폴더 안 파일들에서만 사용할 수 있고 자식 컴포넌트들에서는 사용할 수 없다.<br>\ngetInitialProps가 서버측에서 수행될 때만 필요한 모듈들을 클라이언트 쪽에서 불필요하게 로드되지 않도록 주의한다.</p>","fields":{"slug":"/posts/getInitialProps","tagSlugs":["/tag/react/","/tag/server-side-rendering/","/tag/get-initial-props/"]},"frontmatter":{"date":"2019-10-02","description":"getInitialProps 에 대한 글","tags":["react","server side rendering","getInitialProps"],"title":"getInitialProps"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/getInitialProps"}}}